{
    "header_update": [
        {
            "irule": "ltm rule /Common/header_insert { when HTTP_REQUEST { HTTP::header insert \"X-SOURCE\" \"Akamai\" } }",
            "avi_config": "{\"avi_config\": {\"http_request_policy\": {\"rules\": [{\"header_action\": {\"action\": \"HTTP_REPLACE_HDR\", \"hdr\": {\"name\": \"X-SOURCE\", \"value\": {\"val\": \"Akamai\"}}}}]}, \"name\": \"header_insert\"}, \"rule_name\": \"header_insert\", \"type\": \"HTTPPolicySet\"}"
        }
    ],
    "redirect": [
        {
            "irule": "ltm rule /Common/https_301_redirect.irule {    when HTTP_REQUEST {    HTTP::respond 301 Location \"https://[HTTP::host][HTTP::uri]\"}}",
            "avi_config": "{\"avi_config\": {\"http_request_policy\": {\"enable\": true, \"index\": 1, \"name\": \"https_301_redirect.irule\", \"redirect_action\": {\"keep_query\": true, \"port\": 443, \"protocol\": \"HTTPS\", \"status_code\": \"HTTP_REDIRECT_STATUS_CODE_301\"}}, \"name\": \"https_301_redirect.irule\"}, \"rule_name\": \"https_301_redirect.irule\", \"type\": \"HTTPPolicySet\"}"
        }
    ],
    "content_switch": [
        {
            "irule": "ltm rule /Common/match_path_payment {when HTTP_REQUEST {  if { ([HTTP::uri] contains \"/ws-polling/\") }{      pool payment_pool    }  }}",
            "avi_config": "{\"avi_config\": {\"http_request_policy\": {\"rules\": [{\"enable\": true, \"index\": 1, \"name\": \"match_path_payment\", \"match\": {\"path\": {\"match_case\": \"INSENSITIVE\", \"match_criteria\": \"contains\", \"match_str\": [\"/ws-polling/\"]}}, \"switching_action\": {\"action\": \"HTTP_SWITCHING_SELECT_POOL\", \"pool_ref\": \"/api/pool?name=payment_pool\", \"status_code\": \"HTTP_LOCAL_RESPONSE_STATUS_CODE_200\"}}]}, \"name\": \"match_path_payment\"}, \"rule_name\": \"match_path_payment\", \"type\": \"HTTPPolicySet\"}"
        },
        {
            "irule": "ltm rule /Common/strip_path {when HTTP_REQUEST {   if { [HTTP::path] contains \"-12345\" } then {       HTTP::path [string map {\"/share/-12345/\" \"/share/\"} [HTTP::path]]             pool payment_pool       }  }}",
            "avi_config": "{\"avi_config\": {\"http_request_policy\": {\"rules\": [{\"enable\": true, \"index\": 1, \"name\": \"strip_path\", \"match\": {\"path\": {\"match_case\": \"INSENSITIVE\", \"match_criteria\": \"contains\", \"match_str\": [-12345]}}, \"rewrite_url_action\": {\"path\": {\"tokens\": [{\"end_index\": 0, \"start_index\": 0, \"type\": \"URI_TOKEN_TYPE_PATH\"}, {\"end_index\": 2, \"start_index\": 65535, \"type\": \"URI_TOKEN_TYPE_PATH\"}], \"type\": \"URI_PARAM_TYPE_TOKENIZED\"}, \"query\": {\"keep_query\": true}}, \"switching_action\": {\"action\": \"HTTP_SWITCHING_SELECT_POOL\", \"pool_ref\": \"/api/pool?name=payment_pool\", \"status_code\": \"HTTP_LOCAL_RESPONSE_STATUS_CODE_200\"}}]}, \"name\": \"strip_path\"}, \"rule_name\": \"strip_path\", \"type\": \"HTTPPolicySet\"}"
        },
        {
            "irule": "ltm rule /Common/path_switch {  when HTTP_REQUEST {    switch -glob [HTTP::path] {      \"/gbss-trade*\" {         pool Pool_gbss-trade_front_1     }      \"/gbss-kiosk*\" {         pool Pool_gbss-kiosk_1     }   } }}",
            "avi_config": "{\"avi_config\": {\"http_request_policy\": {\"rules\": [{\"enable\": true, \"index\": 1, \"match\": {\"path\": {\"match_case\": \"INSENSITIVE\", \"match_criteria\": \"CONTAINS\", \"match_str\": [\"/gbss-trade*\"]}}, \"name\": \"path_switch\", \"switching_action\": {\"action\": \"HTTP_SWITCHING_SELECT_POOL\", \"pool_ref\": \"/api/pool?name=Pool_gbss-trade_front_1\", \"status_code\": \"HTTP_LOCAL_RESPONSE_STATUS_CODE_200\"}}, {\"enable\": true, \"index\": 2, \"match\": {\"path\": {\"match_case\": \"INSENSITIVE\", \"match_criteria\": \"CONTAINS\", \"match_str\": [\"/gbss-kiosk*\"]}}, \"name\": \"path_switch\", \"switching_action\": {\"action\": \"HTTP_SWITCHING_SELECT_POOL\", \"pool_ref\": \"/api/pool?name=Pool_gbss-kiosk_1\", \"status_code\": \"HTTP_LOCAL_RESPONSE_STATUS_CODE_200\"}}]}, \"name\": \"path_switch\"}, \"rule_name\": \"path_switch\", \"type\": \"HTTPPolicySet\"}"
        },
        {
            "irule": "ltm rule /Common/path_switch_multi {  when HTTP_REQUEST {    switch -glob [string tolower [HTTP::host]] {        lyncweb.corp.avinetworks.com* { pool avinetworks.lync_reverse_proxy_front_end_4443_pool }        meet.avinetworks.com*   { pool avinetworks.lync_reverse_proxy_front_end_4443_pool  }        dialin.avinetworks.com* { pool avinetworks.lync_reverse_proxy_front_end_4443_pool  }        lyncdiscover.avinetworks.com* { pool avinetworks.lync_reverse_proxy_front_end_4443_pool }        }        }}",
            "avi_config": "{\"avi_config\": {\"http_request_policy\": {\"rules\": [{\"enable\": true, \"index\": 1, \"match\": {\"path\": {\"match_case\": \"INSENSITIVE\", \"match_criteria\": \"CONTAINS\", \"match_str\": [\"lyncweb.corp.avinetworks.com*\"]}}, \"name\": \"path_switch_multi\", \"switching_action\": {\"action\": \"HTTP_SWITCHING_SELECT_POOL\", \"pool_ref\": \"/api/pool?name=avinetworks.lync_reverse_proxy_front_end_4443_pool\", \"status_code\": \"HTTP_LOCAL_RESPONSE_STATUS_CODE_200\"}}, {\"enable\": true, \"index\": 2, \"match\": {\"path\": {\"match_case\": \"INSENSITIVE\", \"match_criteria\": \"CONTAINS\", \"match_str\": [\"meet.avinetworks.com*\"]}}, \"name\": \"path_switch_multi\", \"switching_action\": {\"action\": \"HTTP_SWITCHING_SELECT_POOL\", \"pool_ref\": \"/api/pool?name=avinetworks.lync_reverse_proxy_front_end_4443_pool\", \"status_code\": \"HTTP_LOCAL_RESPONSE_STATUS_CODE_200\"}}, {\"enable\": true, \"index\": 3, \"match\": {\"path\": {\"match_case\": \"INSENSITIVE\", \"match_criteria\": \"CONTAINS\", \"match_str\": [\"dialin.avinetworks.com*\"]}}, \"name\": \"path_switch_multi\", \"switching_action\": {\"action\": \"HTTP_SWITCHING_SELECT_POOL\", \"pool_ref\": \"/api/pool?name=avinetworks.lync_reverse_proxy_front_end_4443_pool\", \"status_code\": \"HTTP_LOCAL_RESPONSE_STATUS_CODE_200\"}}, {\"enable\": true, \"index\": 4, \"match\": {\"path\": {\"match_case\": \"INSENSITIVE\", \"match_criteria\": \"CONTAINS\", \"match_str\": [\"lyncdiscover.avinetworks.com*\"]}}, \"name\": \"path_switch_multi\", \"switching_action\": {\"action\": \"HTTP_SWITCHING_SELECT_POOL\", \"pool_ref\": \"/api/pool?name=avinetworks.lync_reverse_proxy_front_end_4443_pool\", \"status_code\": \"HTTP_LOCAL_RESPONSE_STATUS_CODE_200\"}}]}, \"name\": \"path_switch_multi\"}, \"rule_name\": \"path_switch_multi\", \"type\": \"HTTPPolicySet\"}"
        },
        {
            "irule": "ltm rule /Common/switch_virtualmeeting_filter {when HTTP_REQUEST {    switch -glob [string tolower [HTTP::uri]] {        \"/favicon.ico\" -        \"/example.json\" {            pool p_virtualmeeting03_80        }        }    }}",
            "avi_config": "{\"avi_config\": {\"http_request_policy\": {\"rules\": [{\"enable\": true, \"index\": 2, \"match\": {\"path\": {\"match_case\": \"INSENSITIVE\", \"match_criteria\": \"CONTAINS\", \"match_str\": [\"/example.json\", \"/favicon.ico\"]}}, \"name\": \"switch_virtualmeeting_filter\", \"switching_action\": {\"action\": \"HTTP_SWITCHING_SELECT_POOL\", \"pool_ref\": \"/api/pool?name=p_virtualmeeting03_80\", \"status_code\": \"HTTP_LOCAL_RESPONSE_STATUS_CODE_200\"}}]}, \"name\": \"switch_virtualmeeting_filter\"}, \"rule_name\": \"switch_virtualmeeting_filter\", \"type\": \"HTTPPolicySet\"}"
        },
        {
            "irule": "ltm rule /Common/match_path_paymentv2 {    when HTTP_REQUEST {        switch -glob \"[string tolower [HTTP::path]]\" {            \"/payment1*\" {                pool payment_pool1            }            \"/payment2*\" {                pool payment_pool2            }        }    }}",
            "avi_config": "{\"avi_config\": {\"http_request_policy\": {\"rules\": [{\"enable\": true, \"index\": 1, \"match\": {\"path\": {\"match_case\": \"INSENSITIVE\", \"match_criteria\": \"CONTAINS\", \"match_str\": [\"/payment1*\"]}}, \"name\": \"match_path_paymentv2\", \"switching_action\": {\"action\": \"HTTP_SWITCHING_SELECT_POOL\", \"pool_ref\": \"/api/pool?name=payment_pool1\", \"status_code\": \"HTTP_LOCAL_RESPONSE_STATUS_CODE_200\"}}, {\"enable\": true, \"index\": 2, \"match\": {\"path\": {\"match_case\": \"INSENSITIVE\", \"match_criteria\": \"CONTAINS\", \"match_str\": [\"/payment2*\"]}}, \"name\": \"match_path_paymentv2\", \"switching_action\": {\"action\": \"HTTP_SWITCHING_SELECT_POOL\", \"pool_ref\": \"/api/pool?name=payment_pool2\", \"status_code\": \"HTTP_LOCAL_RESPONSE_STATUS_CODE_200\"}}]}, \"name\": \"match_path_paymentv2\"}, \"rule_name\": \"match_path_paymentv2\", \"type\": \"HTTPPolicySet\"}"
        }

    ]
}
