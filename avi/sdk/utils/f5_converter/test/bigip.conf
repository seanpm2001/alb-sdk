#TMSH-VERSION: 11.6.0

ltm default-node-monitor {
    rule none
}
ltm node /Common/10.90.115.10 {
    address 10.90.115.10
}
ltm node /Common/10.90.115.11 {
    address 10.90.115.11
}
ltm node /Common/192.168.39.30 {
    address 192.168.39.30
}
ltm node /Common/192.168.39.31 {
    address 192.168.39.31
}
ltm node /Common/192.168.40.30 {
    address 192.168.40.30
}
ltm node /Common/F5-Node-Server1 {
    address 192.168.38.10
    connection-limit 200
    description "My First Server F5-Node-Server1"
    monitor /Common/gateway_icmp and /Common/https_443 
    rate-limit 10
}
ltm node /Common/F5-Node-Server2 {
    address 192.168.38.11
    connection-limit 600
    description "My First Server F5-Node-Server2"
    rate-limit 60
}
ltm node /Common/F5-Node-Server3 {
    address 192.168.39.14
    description 192.168.38.14
}
ltm pool /Common/F5-Pool-001 {
    members {
        /Common/10.90.115.10:80 {
            address 10.90.115.10
            description "My Pool Member"
            session user-disabled
        }
        /Common/10.90.115.11:80 {
            address 10.90.115.11
            description "Test Mitch-Chen/Server"
            session user-disabled
        }
        /Common/F5-Node-Server1:80 {
            address 192.168.38.10
            session user-disabled
            state user-down
        }
        /Common/F5-Node-Server2:80 {
            address 192.168.38.11
        }
        /Common/F5-Node-Server3:80 {
            address 192.168.39.14
        }
    }
    monitor /Common/F5-Monitor-HTTP-001 
}
ltm pool /Common/F5-Pool-002 {
    members {
        /Common/192.168.39.30:80 {
            address 192.168.39.30
            connection-limit 100
            priority-group 100
            rate-limit 100
            ratio 100
        }
        /Common/192.168.39.31:80 {
            address 192.168.39.31
            session user-disabled
        }
    }
    monitor /Common/F5-Monitor-ICMP-001 
    reselect-tries 100
    service-down-action reselect
    slow-ramp-time 30
}
ltm pool /Common/F5-Pool-003 {
    members {
        /Common/10.90.115.10:80 {
            address 10.90.115.10
        }
        /Common/192.168.40.30:80 {
            address 192.168.40.30
            connection-limit 1000
            monitor /Common/F5-Monitor-HTTP-001 
            priority-group 30
            rate-limit 50
        }
    }
    monitor /Common/F5-Monitor-HTTPS-001 and /Common/F5-Monitor-TCP-001 and /Common/F5-Monitor-ICMP-001 and /Common/gateway_icmp 
    reselect-tries 100
    service-down-action drop
    slow-ramp-time 100
}
ltm pool /Common/F5-Pool-004 {
    members {
        /Common/10.90.115.10:443 {
            address 10.90.115.10
        }
        /Common/10.90.115.11:443 {
            address 10.90.115.11
        }
    }
    monitor /Common/F5-Monitor-UDP-001 and /Common/gateway_icmp 
}
ltm pool /Common/F5-Pool-005 {
    members {
        /Common/10.90.115.10:80 {
            address 10.90.115.10
            priority-group 20
        }
        /Common/10.90.115.11:80 {
            address 10.90.115.11
            priority-group 20
            session user-disabled
            state user-down
        }
        /Common/192.168.39.30:80 {
            address 192.168.39.30
        }
        /Common/192.168.40.30:80 {
            address 192.168.40.30
        }
        /Common/F5-Node-Server1:80 {
            address 192.168.38.10
            priority-group 20
        }
        /Common/F5-Node-Server2:80 {
            address 192.168.38.11
            priority-group 20
        }
    }
    min-active-members 1
}
ltm pool /Common/testpool {
    members {
        /Common/10.90.115.10:80 {
            address 10.90.115.10
        }
        /Common/10.90.115.11:80 {
            address 10.90.115.11
        }
    }
    monitor /Common/http and /Common/gateway_icmp 
}
ltm rule /Common/F5-iRule-001 {
    
}
ltm rule /Common/F5-iRule-002 {
    
}
ltm rule /Common/F5-iRule-003 {
    
}
ltm rule /Common/SNAT-to-XFF {
    when HTTP_REQUEST {
   if { [HTTP::header exists X-Forwarded-For] } {
      snat [HTTP::header X-Forwarded-For]
   }
}
}
ltm snat-translation /Common/192.168.39.60 {
    address 192.168.39.60
    inherited-traffic-group true
    traffic-group /Common/traffic-group-1
}
ltm snat-translation /Common/192.168.39.62 {
    address 192.168.39.62
    inherited-traffic-group true
    traffic-group /Common/traffic-group-1
}
ltm snatpool /Common/Snat_pool_1 {
    members {
        /Common/192.168.39.60
        /Common/192.168.39.62
    }
}
ltm virtual /Common/EngVIP {
    connection-limit 900
    destination /Common/172.1.1.1:80
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/cookie {
            default yes
        }
    }
    pool /Common/testpool
    profiles {
        /Common/EngSSLProfile {
            context clientside
        }
        /Common/http { }
        /Common/tcp { }
    }
    rate-limit 2000
    rules {
        /Common/_sys_https_redirect
    }
    source 0.0.0.0/0
    source-address-translation {
        type automap
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /Common/F5-VIP-80-001 {
    description "My HTTP VIP"
    destination /Common/192.168.38.20:80
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/ssl {
            default yes
        }
    }
    pool /Common/F5-Pool-001
    profiles {
        /Common/tcp { }
    }
    source 0.0.0.0/0
    source-address-translation {
        type automap
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /Common/F5-VIP-443-001 {
    destination /Common/192.168.38.21:443
    ip-protocol tcp
    mask 255.255.255.255
    pool /Common/F5-Pool-002
    profiles {
        /Common/F5-SSL-ClientSSL-001 {
            context clientside
        }
        /Common/http { }
        /Common/tcp { }
    }
    source 0.0.0.0/0
    source-address-translation {
        type automap
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /Common/F5-VIP-443-002 {
    destination /Common/192.168.38.22:443
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/cookie {
            default yes
        }
    }
    pool /Common/F5-Pool-004
    profiles {
        /Common/F5-SSL-ClientSSL-003 {
            context clientside
        }
        /Common/http { }
        /Common/tcp { }
    }
    source 0.0.0.0/0
    source-address-translation {
        type automap
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /Common/F5-VIP-443-004 {
    destination /Common/192.168.38.25:443
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/source_addr {
            default yes
        }
    }
    pool /Common/F5-Pool-002
    profiles {
        /Common/F5-SSL-ClientSSL-003 {
            context clientside
        }
        /Common/http { }
        /Common/tcp { }
    }
    rules {
        /Common/F5-iRule-002
        /Common/SNAT-to-XFF
    }
    source 0.0.0.0/0
    source-address-translation {
        pool /Common/Snat_pool_1
        type snat
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /Common/testvip {
    destination /Common/10.90.114.121:443
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/dest_addr {
            default yes
        }
    }
    pool /Common/testpool
    profiles {
        /Common/clientssl {
            context clientside
        }
        /Common/http { }
        /Common/tcp-lan-optimized {
            context serverside
        }
        /Common/tcp-wan-optimized {
            context clientside
        }
    }
    source 0.0.0.0/0
    source-address-translation {
        type automap
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /Common/testvip-http-80 {
    destination /Common/10.90.114.121:80
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/source_addr {
            default yes
        }
    }
    pool /Common/testpool
    profiles {
        /Common/http { }
        /Common/tcp { }
    }
    source 0.0.0.0/0
    source-address-translation {
        type automap
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual-address /Common/10.90.114.121 {
    address 10.90.114.121
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm virtual-address /Common/172.1.1.1 {
    address 172.1.1.1
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm virtual-address /Common/192.168.38.20 {
    address 192.168.38.20
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm virtual-address /Common/192.168.38.21 {
    address 192.168.38.21
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm virtual-address /Common/192.168.38.22 {
    address 192.168.38.22
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm virtual-address /Common/192.168.38.25 {
    address 192.168.38.25
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm monitor gateway-icmp /Common/F5-Monitor-ICMP-001 {
    adaptive disabled
    defaults-from /Common/gateway_icmp
    destination *:*
    interval 30
    time-until-up 0
    timeout 91
}
ltm monitor http /Common/EngMonitor {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 5
    ip-dscp 0
    recv 200
    send "GET /index.html \\r\\n"
    time-until-up 0
    timeout 16
}
ltm monitor http /Common/F5-Monitor-HTTP-001 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 5
    ip-dscp 0
    recv 200
    send "GET /index.html\\r\\n"
    time-until-up 0
    timeout 16
}
ltm monitor https /Common/F5-Monitor-HTTPS-001 {
    adaptive disabled
    cipherlist DEFAULT:+SHA:+3DES:+kEDH
    compatibility enabled
    defaults-from /Common/https
    destination *:*
    interval 5
    ip-dscp 0
    recv 200
    send "GET /index.html\\r\\n"
    time-until-up 0
    timeout 16
}
ltm monitor tcp /Common/F5-Monitor-TCP-001 {
    adaptive disabled
    defaults-from /Common/tcp
    destination *:*
    interval 60
    ip-dscp 0
    time-until-up 0
    timeout 121
}
ltm monitor udp /Common/F5-Monitor-UDP-001 {
    adaptive disabled
    debug no
    defaults-from /Common/udp
    description F5-Monitor-UDP-001
    destination *:*
    interval 5
    recv Test
    send "default send string"
    time-until-up 0
    timeout 16
}
ltm profile client-ssl /Common/EngSSLProfile {
    alert-timeout 10
    allow-non-ssl disabled
    app-service none
    cache-size 262144
    cache-timeout 3600
    cert-key-chain {
        default {
            cert /Common/default.crt
            key /Common/default.key
        }
    }
    ciphers DEFAULT
    defaults-from /Common/clientssl
    generic-alert enabled
    handshake-timeout 10
    inherit-certkeychain false
    max-renegotiations-per-minute 5
    mod-ssl-methods disabled
    mode enabled
    options { dont-insert-empty-fragments }
    peer-no-renegotiate-timeout 10
    proxy-ssl disabled
    proxy-ssl-passthrough disabled
    renegotiate-max-record-delay indefinite
    renegotiate-period indefinite
    renegotiate-size indefinite
    renegotiation enabled
    secure-renegotiation require
    server-name none
    session-mirroring disabled
    session-ticket disabled
    sni-default false
    sni-require false
    ssl-sign-hash any
    strict-resume disabled
    unclean-shutdown enabled
}
ltm profile client-ssl /Common/F5-SSL-ClientSSL-001 {
    alert-timeout 10
    allow-non-ssl disabled
    app-service none
    authenticate once
    authenticate-depth 9
    ca-file none
    cache-size 262144
    cache-timeout 3600
    cert-extension-includes { basic-constraints subject-alternative-name }
    cert-key-chain {
        default {
            cert /Common/default.crt
            chain /Common/default.crt
            key /Common/default.key
        }
    }
    cert-lifespan 30
    cert-lookup-by-ipaddr-port disabled
    ciphers DEFAULT
    client-cert-ca none
    crl-file none
    defaults-from /Common/clientssl
    generic-alert enabled
    handshake-timeout 10
    inherit-certkeychain false
    max-renegotiations-per-minute 5
    mod-ssl-methods disabled
    mode enabled
    options { dont-insert-empty-fragments }
    peer-cert-mode ignore
    peer-no-renegotiate-timeout 10
    proxy-ca-cert none
    proxy-ca-key none
    proxy-ssl disabled
    proxy-ssl-passthrough disabled
    renegotiate-max-record-delay indefinite
    renegotiate-period indefinite
    renegotiate-size indefinite
    renegotiation enabled
    retain-certificate true
    secure-renegotiation require
    server-name none
    session-mirroring disabled
    session-ticket disabled
    sni-default false
    sni-require false
    ssl-forward-proxy disabled
    ssl-forward-proxy-bypass disabled
    ssl-sign-hash any
    strict-resume disabled
    unclean-shutdown enabled
}
ltm profile client-ssl /Common/F5-SSL-ClientSSL-002 {
    alert-timeout 10
    allow-non-ssl disabled
    app-service none
    authenticate once
    authenticate-depth 9
    ca-file none
    cache-size 262144
    cache-timeout 3600
    cert-extension-includes { basic-constraints subject-alternative-name }
    cert-key-chain {
        default {
            cert /Common/default.crt
            chain /Common/default.crt
            key /Common/default.key
        }
    }
    cert-lifespan 30
    cert-lookup-by-ipaddr-port disabled
    ciphers DEFAULT
    client-cert-ca none
    crl-file none
    defaults-from /Common/clientssl
    generic-alert enabled
    handshake-timeout 10
    inherit-certkeychain false
    max-renegotiations-per-minute 5
    mod-ssl-methods disabled
    mode enabled
    options { dont-insert-empty-fragments }
    peer-cert-mode ignore
    peer-no-renegotiate-timeout 10
    proxy-ca-cert none
    proxy-ca-key none
    proxy-ssl disabled
    proxy-ssl-passthrough disabled
    renegotiate-max-record-delay indefinite
    renegotiate-period indefinite
    renegotiate-size indefinite
    renegotiation enabled
    retain-certificate true
    secure-renegotiation require
    server-name none
    session-mirroring disabled
    session-ticket disabled
    sni-default false
    sni-require false
    ssl-forward-proxy disabled
    ssl-forward-proxy-bypass disabled
    ssl-sign-hash any
    strict-resume disabled
    unclean-shutdown enabled
}
ltm profile client-ssl /Common/F5-SSL-ClientSSL-003 {
    alert-timeout 10
    allow-non-ssl disabled
    app-service none
    authenticate once
    authenticate-depth 9
    ca-file none
    cache-size 262144
    cache-timeout 3600
    cert-extension-includes { basic-constraints subject-alternative-name }
    cert-key-chain {
        default {
            cert /Common/default.crt
            chain /Common/default.crt
            key /Common/default.key
        }
    }
    cert-lifespan 30
    cert-lookup-by-ipaddr-port disabled
    ciphers DEFAULT
    client-cert-ca none
    crl-file none
    defaults-from /Common/clientssl
    generic-alert enabled
    handshake-timeout 10
    inherit-certkeychain false
    max-renegotiations-per-minute 5
    mod-ssl-methods disabled
    mode enabled
    options { dont-insert-empty-fragments }
    peer-cert-mode ignore
    peer-no-renegotiate-timeout 10
    proxy-ca-cert none
    proxy-ca-key none
    proxy-ssl disabled
    proxy-ssl-passthrough disabled
    renegotiate-max-record-delay indefinite
    renegotiate-period indefinite
    renegotiate-size indefinite
    renegotiation enabled
    retain-certificate true
    secure-renegotiation require
    server-name none
    session-mirroring disabled
    session-ticket disabled
    sni-default false
    sni-require false
    ssl-forward-proxy disabled
    ssl-forward-proxy-bypass disabled
    ssl-sign-hash any
    strict-resume disabled
    unclean-shutdown enabled
}
net route /Common/dg {
    gw 10.90.114.1
    network default
}
net ipsec ike-daemon /Common/ikedaemon { }
pem global-settings analytics { }
security dos udp-portlist /Common/dos-udp-portlist {
    entries {
        entry1 {
            match-direction both
            port-number 53
        }
    }
    list-type exclude-listed-ports
}
sys software update {
    auto-check enabled
    frequency weekly
}
wom endpoint-discovery { }
